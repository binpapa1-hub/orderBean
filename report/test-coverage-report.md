# OrderBean 테스트 커버리지 리포트

**생성일**: 2025년 12월 17일

---

## 요약

| 영역 | 테스트 수 | 통과 | 실패 | 통과율 |
|------|----------|------|------|--------|
| 프론트엔드 | 23 | 16 | 7 | 69.5% |
| 백엔드 | 67 | 0* | 67* | 0%* |
| **총계** | **90** | **16** | **74** | - |

> *백엔드 테스트는 MongoDB 연결 실패로 실행되지 않음

---

## 프론트엔드 테스트 커버리지 (Vitest)

### 컴포넌트별 결과

| 파일 | 테스트 수 | 통과 | 실패 | 상태 |
|------|----------|------|------|------|
| `Navbar.jsx` | 4 | 4 | 0 | ✅ 완료 |
| `PrivateRoute.jsx` | 3 | 3 | 0 | ✅ 완료 |
| `AuthContext.jsx` | 8 | 8 | 0 | ✅ 완료 |
| `Login.jsx` | 8 | 1 | 7 | ⚠️ 수정 필요 |

### 테스트 상세

#### Navbar.jsx (4/4 통과)
- ✅ 로그인 전 네비게이션 렌더링
- ✅ 로고 및 링크 표시
- ✅ 관리자 링크 조건부 표시
- ✅ 로그아웃 기능

#### PrivateRoute.jsx (3/3 통과)
- ✅ 인증된 사용자 접근 허용
- ✅ 비인증 사용자 리다이렉트
- ✅ 역할 기반 접근 제어

#### AuthContext.jsx (8/8 통과)
- ✅ AuthProvider 컨텍스트 제공
- ✅ Provider 외부 사용 시 에러
- ✅ 토큰 기반 사용자 조회
- ✅ 로그인 성공
- ✅ 로그인 실패
- ✅ 회원가입 성공
- ✅ 로그아웃
- ✅ 토큰 만료 시 정리

#### Login.jsx (1/8 통과)
- ✅ 회원가입 링크 표시
- ❌ 로그인 폼 렌더링 (중복 텍스트 쿼리 이슈)
- ❌ 이메일 입력 업데이트 (label 연결 이슈)
- ❌ 비밀번호 입력 업데이트 (label 연결 이슈)
- ❌ 로그인 API 호출 (label 연결 이슈)
- ❌ 로그인 성공 시 네비게이션 (label 연결 이슈)
- ❌ 로그인 실패 시 에러 표시 (label 연결 이슈)
- ❌ 필수 입력 검증 (label 연결 이슈)

> **수정 방안**: Login.jsx의 label에 `htmlFor` 속성 추가 또는 테스트에서 `getByPlaceholderText` 사용

---

## 백엔드 테스트 커버리지 (Jest)

### 코드 커버리지 (MongoDB 미연결 상태)

| 카테고리 | Statements | Branch | Functions | Lines |
|----------|------------|--------|-----------|-------|
| **전체** | 23.7% | 0% | 3.22% | 24.33% |

### 파일별 커버리지

| 파일 | Statements | Branch | Functions | Lines | 미커버 라인 |
|------|------------|--------|-----------|-------|-------------|
| **middleware** |
| auth.js | 27.27% | 0% | 33.33% | 27.27% | 5-22, 28-36 |
| **models** |
| Cafe.js | 100% | 100% | 100% | 100% | - |
| Menu.js | 100% | 100% | 100% | 100% | - |
| Order.js | 71.42% | 100% | 0% | 71.42% | 76-77 |
| User.js | 54.54% | 0% | 0% | 60% | 43-45, 50 |
| **routes** |
| admin.js | 15.46% | 0% | 0% | 15.95% | 17-36, 44-77, 85-98, 106-124, 132-153, 161-191 |
| auth.js | 23.91% | 0% | 0% | 23.91% | 11, 22-60, 71-104, 112-117 |
| cafes.js | 21.87% | 0% | 0% | 21.87% | 11-36, 44-67 |
| menus.js | 28% | 0% | 0% | 30.43% | 11-22, 30-38 |
| orders.js | 16.12% | 0% | 0% | 16.66% | 12-60, 68-77, 85-102, 110-132 |

### 테스트 케이스 목록

#### auth.test.js (15개 테스트)
- 회원가입 성공
- 이메일 중복 시 400 에러
- 이름 누락 시 400 에러
- 이메일 형식 오류 시 400 에러
- 비밀번호 6자 미만 시 400 에러
- merchant 역할로 회원가입
- 로그인 성공
- 이메일 형식 오류 시 400 에러
- 비밀번호 누락 시 400 에러
- 존재하지 않는 사용자 로그인 시 400 에러
- 잘못된 비밀번호 시 400 에러
- 유효한 토큰으로 사용자 정보 조회
- 토큰 없이 요청 시 401 에러
- 잘못된 토큰으로 요청 시 401 에러

#### cafes.test.js (7개 테스트)
- 영업 중인 카페 목록 조회
- 영업 종료 카페 미포함
- 위치 기반 카페 필터링
- 반경 내 카페 없을 시 빈 배열
- 카페 ID로 상세 조회
- 존재하지 않는 카페 404 에러
- 잘못된 ID 형식 500 에러

#### menus.test.js (8개 테스트)
- 사용 가능한 메뉴 목록 조회
- 품절 메뉴 미포함
- 카페별 메뉴 필터링
- 카테고리별 메뉴 필터링
- 카페+카테고리 복합 필터링
- 메뉴 ID로 상세 조회
- 존재하지 않는 메뉴 404 에러
- 카페 정보 populate

#### orders.test.js (17개 테스트)
- 주문 생성 성공
- 미인증 시 401 에러
- 품절 메뉴 주문 시 400 에러
- 총액 계산 검증
- 예상 픽업 시간 설정
- 사용자 주문 목록 조회
- 미인증 시 401 에러
- 다른 사용자 주문 미포함
- 주문 ID로 상세 조회
- 존재하지 않는 주문 404 에러
- 다른 사용자 주문 접근 시 403 에러
- 주문 취소 성공
- 존재하지 않는 주문 취소 시 404 에러
- 다른 사용자 주문 취소 시 403 에러
- ready 상태 주문 취소 불가
- completed 상태 주문 취소 불가

#### admin.test.js (20개 테스트)
- 관리자 주문 목록 조회
- 미인증 시 401 에러
- 일반 사용자 접근 시 403 에러
- 소유 카페 주문만 조회
- 주문 상태 업데이트
- ready 시 actualPickupTime 설정
- 잘못된 상태값 400 에러
- 존재하지 않는 주문 404 에러
- 소유하지 않은 카페 주문 403 에러
- 관리자 메뉴 목록 조회
- 미인증 시 401 에러
- 메뉴 생성
- 소유하지 않은 카페에 메뉴 생성 403 에러
- 메뉴 수정
- 존재하지 않는 메뉴 404 에러
- 소유하지 않은 카페 메뉴 수정 403 에러
- 판매 통계 조회
- 미인증 시 401 에러

---

## 테스트 환경

### 프론트엔드
- **테스트 러너**: Vitest 1.1.0
- **테스트 라이브러리**: @testing-library/react 14.1.2
- **DOM 환경**: jsdom 23.0.1

### 백엔드
- **테스트 러너**: Jest 29.7.0
- **HTTP 테스트**: Supertest 6.3.3
- **데이터베이스**: MongoDB (테스트용 별도 DB)

---

## 실행 방법

### 프론트엔드 테스트
```bash
cd frontend
npm test              # Watch 모드
npm run test:coverage # 커버리지 리포트
```

### 백엔드 테스트
```bash
# MongoDB 실행 필요
cd backend
npm test              # 커버리지 포함 실행
```

---

## 개선 사항

### 즉시 해결 가능
1. **Login.jsx 테스트 수정**: label-input 연결 쿼리 방식 변경
2. **MongoDB 시작**: 백엔드 테스트 전체 실행

### 향후 추가 권장
1. 추가 페이지 테스트 (Register, Cafes, Menu, Cart, Orders)
2. E2E 테스트 추가 (Cypress 또는 Playwright)
3. CI/CD 파이프라인에 테스트 통합

---

## 결론

- **프론트엔드**: 핵심 컴포넌트(Navbar, PrivateRoute, AuthContext) 테스트 완료
- **백엔드**: 모든 API 엔드포인트에 대한 테스트 케이스 작성 완료
- **다음 단계**: MongoDB 실행 후 백엔드 테스트 확인, Login 테스트 수정

