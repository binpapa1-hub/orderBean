# 관리자 대시보드 화면 TDD 구현 보고서

## 작업 요약

| 항목 | 내용 |
|------|------|
| 작업일 | 2025-12-17 |
| 작업자 | 개발팀 |
| 방법론 | TDD (Test-Driven Development) |
| 산출물 | `src/pages/AdminDashboardNew.jsx`, `src/tests/pages/AdminDashboard.test.jsx` |

---

## TDD 단계별 진행

### 1단계: RED - 실패하는 테스트 작성

**파일**: `frontend/src/tests/pages/AdminDashboard.test.jsx`

총 24개의 테스트 케이스 작성:

#### 1.1 헤더 테스트 (3개)
| 테스트 | 설명 |
|--------|------|
| 로고 표시 | COZY 로고가 표시되어야 함 |
| 주문하기 링크 | 주문하기 링크가 있어야 함 |
| 관리자 버튼 | 관리자 버튼이 있어야 함 |

#### 1.2 관리자 대시보드 섹션 테스트 (5개)
| 테스트 | 설명 |
|--------|------|
| 제목 표시 | "관리자 대시보드" 제목 |
| 총 주문 수 | 총 주문 수 표시 |
| 주문 접수 수 | 주문 접수 수 표시 |
| 제조 중 수 | 제조 중 수 표시 |
| 제조 완료 수 | 제조 완료 수 표시 |

#### 1.3 재고 현황 섹션 테스트 (8개)
| 테스트 | 설명 |
|--------|------|
| 제목 표시 | "재고 현황" 제목 |
| 메뉴 3개 표시 | 아메리카노 ICE/HOT, 카페라떼 |
| 재고 수량 표시 | X개 형식으로 표시 |
| + 버튼 존재 | 재고 증가 버튼 3개 |
| - 버튼 존재 | 재고 감소 버튼 3개 |
| + 클릭 시 증가 | 재고 1 증가 |
| - 클릭 시 감소 | 재고 1 감소 |
| 정상 상태 표시 | 10개 이상이면 "정상" |

#### 1.4 주문 현황 섹션 테스트 (6개)
| 테스트 | 설명 |
|--------|------|
| 제목 표시 | "주문 현황" 제목 |
| 날짜/시간 표시 | M월 D일 HH:mm 형식 |
| 주문 메뉴 표시 | 메뉴명 x 수량 |
| 금액 표시 | X,XXX원 형식 |
| 주문 접수 버튼 | 초기 상태 버튼 |
| 상태 변경 | 클릭 시 제조 시작으로 변경 |

#### 1.5 재고 상태 표시 테스트 (2개)
| 테스트 | 설명 |
|--------|------|
| 5개 미만 "주의" | 노란색 주의 표시 |
| 0개 "품절" | 빨간색 품절 표시 |

---

### 2단계: GREEN - 최소한의 코드로 통과

**파일**: `frontend/src/pages/AdminDashboardNew.jsx`

구현된 기능:

1. **관리자 대시보드 섹션**
   - 총 주문 / 주문 접수 / 제조 중 / 제조 완료 4개 항목
   - 각 상태별 주문 수 계산

2. **재고 현황 섹션**
   - 메뉴 3개 (아메리카노 ICE/HOT, 카페라떼)
   - 재고 수량 + 상태 표시 (정상/주의/품절)
   - +/- 버튼으로 재고 조절

3. **주문 현황 섹션**
   - 주문 날짜/시간, 메뉴, 금액 표시
   - 상태 변경 버튼 (주문 접수 → 제조 시작 → 제조 중 → 완료)

---

### 3단계: REFACTOR - 코드 개선

개선 사항:

1. **재고 상태 로직 함수화**
   - `getStockStatus(stock)` 함수로 분리
   - 0개: 품절 (빨간색)
   - 5개 미만: 주의 (노란색)
   - 5개 이상: 정상 (초록색)

2. **상태 변경 플로우**
   - pending → confirmed → preparing → ready → completed
   - 버튼 텍스트 자동 변경

3. **날짜 포맷 함수**
   - `formatDate(dateString)` 함수로 분리
   - "M월 D일 HH:mm" 형식

---

## 테스트 결과

```
 ✓ src/tests/pages/AdminDashboard.test.jsx (24 tests) 806ms

 Test Files  1 passed (1)
      Tests  24 passed (24)
```

**테스트 커버리지**: 24/24 (100%)

---

## 구현된 화면 구조

```
┌─────────────────────────────────────────────────────────┐
│  [OrderBean - 커피 주문]          [주문하기]  [관리자]   │
├─────────────────────────────────────────────────────────┤
│  관리자 대시보드                                        │
│  ───────────────                                        │
│  총 주문 1 / 주문 접수 1 / 제조 중 0 / 제조 완료 0     │
├─────────────────────────────────────────────────────────┤
│  재고 현황                                              │
│  ───────────                                            │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐    │
│  │아메리카노ICE │ │아메리카노HOT │ │ 카페라떼     │    │
│  │ 10개 정상    │ │ 10개 정상    │ │ 10개 정상    │    │
│  │ [+] [-]     │ │ [+] [-]     │ │ [+] [-]     │    │
│  └──────────────┘ └──────────────┘ └──────────────┘    │
├─────────────────────────────────────────────────────────┤
│  주문 현황                                              │
│  ─────────                                              │
│  7월 31일 13:00   아메리카노(ICE) x 1   4,000원  [접수] │
└─────────────────────────────────────────────────────────┘
```

---

## 재고 상태 표시 규칙

| 재고 수량 | 상태 | 색상 |
|----------|------|------|
| 0개 | 품절 | 빨간색 |
| 1~4개 | 주의 | 노란색 |
| 5개 이상 | 정상 | 초록색 |

---

## 주문 상태 플로우

```
주문 접수 → 제조 시작 → 제조 중 → 제조 완료 → 완료
(pending)   (confirmed)  (preparing) (ready)   (completed)
```

---

## 파일 목록

| 파일 | 설명 |
|------|------|
| `frontend/src/pages/AdminDashboardNew.jsx` | 관리자 대시보드 컴포넌트 |
| `frontend/src/tests/pages/AdminDashboard.test.jsx` | 테스트 파일 (24개 테스트) |

---

## 다음 단계

1. 실제 API 연동 (GET /api/admin/stats, /api/admin/menus, /api/admin/orders)
2. 재고 변경 API 연동 (PATCH /api/admin/menus/{id})
3. 주문 상태 변경 API 연동 (PATCH /api/admin/orders/{id}/status)
4. 실시간 주문 업데이트 (향후 WebSocket)

---

**보고서 작성 완료**

